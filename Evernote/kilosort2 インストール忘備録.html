<html>
<head>
  <title>Evernote Export</title>
  <basefont face="メイリオ" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/309198 (ja-JP, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: メイリオ;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="10799"/>

<div><span><div>kilosort2 インストール忘備録</div><div><br/></div><div>・手順</div><div><br/></div><div>1) Matlab をインストール。</div><div>    Matlab2018a が必須。それ以降だと、VC++2013と互換性がなくなる。</div><div>    Parallel Computing Toolbox が必須となる</div><div><br/></div><div>☆ Cudaの前に、nvidiaのドライバをインストールしたほうが良いかも。</div><div>　 （DeepLabCut参照。）</div><div style="text-align:start;background-color:rgb(255, 255, 255);padding-left:40px;"><b><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(222, 87, 0);">FIRST</span></span></span></b><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(222, 87, 0);">, install a driver for your GPU (we recommend the 384.xx) Find DRIVER HERE:</span><span style="color:rgb(36, 41, 46);"> </span><a href="https://www.nvidia.com/download/index.aspx" rev="en_rl_none"><span style="color:rgb(3, 102, 214);">https://www.nvidia.com/download/index.asp</span></a></span></span></div><div style="padding-left:40px;">ーー＞Quadro RTX 4000</div><div style="padding-left:40px;">　　　・Windows Driver Type:　でDCHを選ばないとエラーが出た</div><div><br/></div><div>2) cuda 9.0 をインストール</div><div>    2)~4)までは、kilosort のインストールガイドが分かりやすい。</div><div>　 Evernote の「cortex-lab/KiloSort」のノート、または以下を参照</div><div>    <a href="https://github.com/cortex-lab/KiloSort" rev="en_rl_none">https://github.com/cortex-lab/KiloSort</a></div><div><br/></div><div>3) visual studio 2013 community をインストール。</div><div><br/></div><div>4) Matlab上でのコンパイラーをインストール。</div><hr/><div>2)~4)の解説</div><h4 style="text-align:start;"><b><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(167, 69, 0);">    Windows 10 installation</span></span></span></b></h4><ol><ol><li><div><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(167, 69, 0);">Install matlab R2018a from </span><a href="http://www.mathworks.com/" rev="en_rl_none"><span style="color:rgb(167, 69, 0);">www.mathworks.com</span></a><span style="color:rgb(167, 69, 0);">. You can use older versions of matlab but see notes below.</span></span></span></div></li><li><div><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(167, 69, 0);">Install cuda 9.0 from </span><a href="https://developer.nvidia.com/cuda-90-download-archive" rev="en_rl_none"><span style="color:rgb(167, 69, 0);">https://developer.nvidia.com/cuda-90-download-archive</span></a><span style="color:rgb(167, 69, 0);">. This version of CUDA works with Matlab R2018a. For older versions of matlab, skip this for now, and at a later stage it will tell you what version of CUDA you need. Then search on google or the NVIDIA site for that version.</span></span></span></div></li><li><div><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(167, 69, 0);">Install visual studio 2013 community from </span><a href="https://www.visualstudio.com/vs/older-downloads/" rev="en_rl_none"><span style="color:rgb(167, 69, 0);">https://www.visualstudio.com/vs/older-downloads/</span></a><span style="color:rgb(167, 69, 0);">. Installing this should come after installing matlab or else matlab may not find the compiler, in which case you won't see it in the mex setup list (see below). You should be able to install again on top of an old installation, if you already had it from before matlab installation.</span></span></span></div></li><li><div><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><span style="font-size: 16px;"><span style="color:rgb(167, 69, 0);">Now in matlab, choose the compiler:.</span></span></span></div></li></ol></ol><div style="padding-left:40px;"><span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(36, 41, 46);">&gt;&gt; mex -setup C++</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">%</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">gives an output like below:</span></span></span></div><div style="padding-left:40px;"><br/></div><div style="padding-left:40px;"><span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(36, 41, 46);">To</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(3, 47, 98);">choose a different C++ compiler, select one from the following:</span><span style="color:rgb(36, 41, 46);">MinGW64</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(3, 47, 98);">Compiler (C++) mex -setup:'C:\Program Files\MATLAB\R2018a\bin\win64\mexopts\mingw64_g++.xml' C++</span><span style="color:rgb(36, 41, 46);">MinGW64</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(3, 47, 98);">Compiler with Windows 10 SDK or later (C++) mex -setup:'C:\Program Files\MATLAB\R2018a\bin\win64\mexopts\mingw64_g++_sdk10+.xml' C++</span><span style="color:rgb(36, 41, 46);">Microsoft</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(3, 47, 98);">Visual C++ 2013 mex -setup:'C:\Program Files\MATLAB\R2018a\bin\win64\mexopts\msvcpp2013.xml' C++</span></span></span></div><div style="padding-left:40px;"><br/></div><div style="padding-left:40px;"><span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">%</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">you want to pick the 2013 edition, so copy and paste the corresponding instruction. For me that's:</span></span></span></div><div style="padding-left:40px;"><span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(36, 41, 46);">&gt;&gt; mex -setup:</span><span style="color:rgb(3, 47, 98);">'C:\Program Files\MATLAB\R2018a\bin\win64\mexopts\msvcpp2013.xml'</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(36, 41, 46);">C++</span></span></span></div><hr/><div><br/></div><div>5) Kilosort2のサイトから、フォルダごとダウンロードする。（あるいはGitHubでクローンする。）</div><div>　https://github.com/MouseLand/Kilosort2</div><div>    そのフォルダに行って、その下のCUDAフォルダにある　mexGPUall.m　を走らせる。</div><div>    (これも、kilosort のインストールガイドのほうが分かりやすい。)</div><div>    ここまででインストールが完了。</div><div><br/></div><div style="background-color:rgb(246, 248, 250);"><span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(36, 41, 46);">&gt;&gt; cd C:\my\github\directory\KiloSort\CUDA</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">%</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">your kilosort repository directory</span></span></span></div><div style="background-color:rgb(246, 248, 250);"><span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(36, 41, 46);">&gt;&gt; mexGPUall</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">%</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">should get a bunch of warnings plus &quot;MEX completed successfully&quot;, several times.</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">%</span></span></span> <span style="font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;"><span style="font-size: 13.6px;"><span style="color:rgb(106, 115, 125);">at this stage it may tell you that you need a different version of cuda for older matlab installations.</span></span></span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 